<html>
	<head>
		<meta charset="utf-8"> 
		<title>Tests navigator.interests functionality</title>
		<style>
			body {
				text-align: center;
				font-family: arial;
			}
		</style>
	</head>
	<body>
		<h1>Interest Signal: Demo</h1>
		<br>
		<br>
		<br>
		<p>
			Your top interest is: <span id='top_interest'></span>
		</p>
		<p>
			<input type='button' value='Request Interests' id='btn'>
		</p>
		<script>
			
			//similar functionality to navigator.geolocation
			function success(interests) {
				console.log('In-page success function called, interests was: ' + JSON.stringify(interests))
				document.getElementById("top_interest").innerHTML = interests.list[0]
			};
			
			function error() {
				console.log('In-page error function called')
				document.getElementById("top_interest").innerHTML = "User denied request"
			};
			
			//When the button is clicked, request permissions
			document.getElementById('btn').onclick = function(){navigator.interests.getInterests(success, error);}
			
			//How can we get this to work on page load?
			//this doesn't work:
			//window.addEventListener("DOMContentLoaded", function(){navigator.interests.getInterests(success, error);})
			// - The extension is fired on contentScriptWhen ready which appears to be after DOMContentLoaded. The only
			//    other option is contentScriptWhen:start, which doesn't work
			//    because the DOM hasn't loaded at all and the function can't be attached.
			// - Is the page forced to use hacky Timeouts to check if it has been added to the DOM? Or is there a way of
			//    inserting it in time?
			
		</script>
	</body>
</html>



